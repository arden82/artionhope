<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>天龍Artion</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="keywords" />
  <meta content="" name="description" />

  <!-- Favicon -->
  <link href="img/favicon.ico" rel="icon" />

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Icon Font Stylesheet -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- Libraries Stylesheet -->
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />
  <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/bootstrap.min.css" rel="stylesheet" />

  <!-- Template Stylesheet -->
  <link href="css/style.css" rel="stylesheet" />

  <!-- font-awesome -->
  <script src="https://kit.fontawesome.com/c89374f433.js" crossorigin="anonymous"></script>
</head>

<body>
  <div class="container-xxl position-relative bg-white d-flex p-0">
    <!-- Spinner Start -->
    <div id="spinner"
      class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem" role="status">
        <span class="sr-only">Loading...</span>
      </div>
    </div>
    <!-- Spinner End -->

    <!-- Sidebar Start -->
    <div class="sidebar pe-4 pb-3">
      <nav class="navbar bg-light navbar-light">
        <a href="index.html" class="navbar-brand mx-4 mb-3 artionimg">
          <!-- <h3 class="text-primary"><i class="fa fa-hashtag me-2"></i>DASHMIN</h3> -->
          <img src="./img/artion-logo.png" />
        </a>
        <div class="d-flex align-items-center ms-4 mb-4">
          <div class="position-relative">
            <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px" id="adminPhoto1" />
            <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1">
            </div>
          </div>
          <div class="ms-3">
            <h6 class="mb-0"><span id="admName"></span> </h6>
            <span>Admin</span>
          </div>
        </div>
        <div class="navbar-nav w-100">
          <a href="index.html" class="nav-item nav-link"><i class="fa-solid fa-address-card"></i>會員總覽</a>
          <a href="memberOrderManage.html" class="nav-item nav-link"><i class="fa-solid fa-table-list"></i> 會員訂單管理</a>
          <a href="firm.html" class="nav-item nav-link"><i class="fa-solid fa-building-user"></i> 廠商總覽</a>
          <a href="activityManage.html" class="nav-item nav-link "><i class="fa-solid fa-calendar-check"></i>廠商活動管理</a>

          <a href="../adminchat/adminchat.html" class="nav-item nav-link"><i class="fa-solid fa-comments"></i> 即時客服</a>
          <a href="product.html" class="nav-item nav-link active"><i class="fa-solid fa-box"></i> 周邊商品</a>
          <a href="codeSetting.html" class="nav-item nav-link"><i class="fa-solid fa-barcode"></i> 優惠碼設定</a>
          <a href="manager.html" class="nav-item nav-link"><i class="fa-solid fa-user-tie"></i> 管理者管理</a>
          <a href="notification.html" class="nav-item nav-link"><i class="fa-solid fa-envelope"></i> 通知信</a>
        </div>
      </nav>
    </div>
    <!-- Sidebar End -->

    <!-- Content Start -->
    <div class="content">
      <!-- Navbar Start -->
      <nav class="navbar navbar-expand bg-light navbar-light sticky-top px-4 py-0">
        <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
          <h2 class="text-primary mb-0"><i class="fa fa-hashtag"></i></h2>
        </a>
        <a href="#" class="sidebar-toggler flex-shrink-0">
          <i class="fa fa-bars"></i>
        </a>
        <form class="d-none d-md-flex ms-4">
          <input class="form-control border-0" type="search" placeholder="Search" />
        </form>
        <div class="navbar-nav align-items-center ms-auto">


          <div class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
              <img class="rounded-circle me-lg-2" src="img/user.jpg" alt="" style="width: 40px; height: 40px"
                id="adminPhoto2" />
              <span id="admName2"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">

              <a href="signin.html" class="dropdown-item" id="logOut">Log Out</a>
            </div>
          </div>
        </div>
      </nav>
      <!-- Navbar End -->

      <div class="col-12">
        <div class="bg-light rounded h-100 p-4">
          <div class="row">
            <h6 class="col-md-3 mb-3" style="font-size: 24px"><a href="">商品管理</a></h6>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="input-group">
                <input class="form-control border" type="search" placeholder="Search" />
                <button type="submit" class="btn btn-primary">搜尋</button>
                <button type="button" class="btn btn-secondary">重設</button>
              </div>
            </div>

            <div class="col-md-2 mb-3 d-flex align-items-center">
              <select class="form-select" id="floatingSelect2" aria-label="Floating label select example">
                <option selected>類別</option>
                <option value="1">男</option>
                <option value="2">女</option>
              </select>
            </div>
          </div>

          <div class="bg-light rounded h-100 p-4" id="merchContent"></div>
        </div>
      </div>

      <!-- Footer Start -->
      <div class="container-fluid pt-4 px-4">
        <div class="bg-light rounded-top p-4">
          <div class="row">
            <div class="col-12 col-sm-6 text-center text-sm-start">&copy; <a href="#">天龍Artion</a>, All Right Reserved.
            </div>
            <div class="col-12 col-sm-6 text-center text-sm-end">
              <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
              Designed By <a href="https://htmlcodex.com">HTML Codex</a>

              Distributed By <a class="border-bottom" href="https://themewagon.com" target="_blank">ThemeWagon</a>
            </div>
          </div>
        </div>
      </div>
      <!-- Footer End -->
    </div>
    <!-- Content End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
  </div>

  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/chart/chart.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="lib/tempusdominus/js/moment.min.js"></script>
  <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
  <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>

  <script>
    function getMerchData() {
      var urlParams = new URLSearchParams(window.location.search);
      merchId = urlParams.get("merchId");

      console.log(merchId);
      if (merchId) {
        $.ajax({
          type: "GET",
          url: `${window.location, path}/artion/showOneMerch`, // 指向您的Servlet URL
          data: { merchId: merchId }, // 替换成您的商品ID
          dataType: "json",
          success: function (data) {
            // data 包含从服务器返回的商品信息

            // 在页面上显示商品信息
            var merchContent = document.getElementById("merchContent");
            var merchInfo = document.createElement("div");

            merchInfo.innerHTML = `
        <div class="merch-info">
            <div class="product-title">${data.merchName}</div>
            <div class="product-images">
                <img src="${window.location, path}/MerchPhoto?merchId=${data.merchId}&merchPicture=1" alt="商品圖片1" />
                <img src="${window.location, path}/MerchPhoto?merchId=${data.merchId}&merchPicture=2" alt="商品圖片2" />
                <img src="${window.location, path}/MerchPhoto?merchId=${data.merchId}&merchPicture=3" alt="商品圖片3" />
                <img src="${window.location, path}/MerchPhoto?merchId=${data.merchId}&merchPicture=4" alt="商品圖片4" />
            </div>
            <div class="product-info"><strong>周边商品編號:</strong> ${data.merchId}</div>
            <div class="product-info"><strong>周边商品總數:</strong> ${data.merchTotal}</div>
            <div class="product-info"><strong>周边商品單價:</strong> ${data.merchPrice}</div>
            <div class="product-info"><strong>周边商品類別:</strong> ${data.merchSort}</div>
            <div class="product-info"><strong>周边商品上架時間:</strong> ${data.merchStartTime}</div>
            <div class="product-info"><strong>周边商品下架時間:</strong> ${data.merchEndTime}</div>
            <div class="product-info"><strong>周边商品描述:</strong> ${data.merchIntroduction}</div>
            <div class="product-info"><strong>銷售數量:</strong> ${data.merchSellAmount}</div>
            <div class="product-info"><strong>上下架狀態:</strong> ${data.merchStatus}</div>
        </div>
    `;

            merchContent.appendChild(merchInfo);
          },
          error: function (error) {
            // 处理Ajax错误
          },
        });
      }
    }

    $(document).ready(function () {
      let path = window.location.pathname;
      path = path.substring(0, path.indexOf("/", 1));
      const admId = localStorage.getItem("admId");
      const admName = localStorage.getItem("admName");
      console.log(admId);
      console.log(admName);

      if (admId != null) {
        const admNameSpan = $("#admName");
        const admNameSpan2 = $("#admName2");

        const adminPhoto1 = $("#adminPhoto1");
        const adminPhoto2 = $("#adminPhoto2");

        console.log(adminPhoto1);

        admNameSpan.text(admName);
        admNameSpan2.text(admName);

        $("#logOut").on("click", function () {
          localStorage.removeItem("admId");
          localStorage.removeItem("admName");

        });


        // const initialImageUrl = "img/user.jpg";
        // http://localhost:8081/artion/adminphoto?admId=1001
        const alternateImageUrl = window.location.origin + path + "/adminphoto?admId=" + admId;

        // let isInitialImage = true;

        adminPhoto1.attr("src", alternateImageUrl);
        adminPhoto2.attr("src", alternateImageUrl);

      } else {
        window.location.href = window.location.origin + path + "signin.html";
      }
      getMerchData();
    });
  </script>
</body>

</html>