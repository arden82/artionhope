<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>天龍Artion</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="keywords" />
  <meta content="" name="description" />

  <!-- Favicon -->
  <link href="img/favicon.ico" rel="icon" />

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Icon Font Stylesheet -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- Libraries Stylesheet -->
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />
  <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/bootstrap.min.css" rel="stylesheet" />

  <!-- Template Stylesheet -->
  <link href="css/style.css" rel="stylesheet" />

  <!-- font-awesome -->
  <script src="https://kit.fontawesome.com/c89374f433.js" crossorigin="anonymous"></script>
</head>

<body>
  <div class="container-xxl position-relative bg-white d-flex p-0">
    <!-- Spinner Start -->
    <div id="spinner"
      class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem" role="status">
        <span class="sr-only">Loading...</span>
      </div>
    </div>
    <!-- Spinner End -->

    <!-- Sidebar Start -->
    <div class="sidebar pe-4 pb-3">
      <nav class="navbar bg-light navbar-light">
        <a href="index.html" class="navbar-brand mx-4 mb-3 artionimg">
          <!-- <h3 class="text-primary"><i class="fa fa-hashtag me-2"></i>DASHMIN</h3> -->
          <img src="./img/artion-logo.png" />
        </a>
        <div class="d-flex align-items-center ms-4 mb-4">
          <div class="position-relative">
            <img class="rounded-circle" src="img/user.jpg" alt="" style="width: 40px; height: 40px" id="adminPhoto2" />
            <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1">
            </div>
          </div>
          <div class="ms-3">
            <h6 class="mb-0"><span id="admName"></span></h6>
            <span>Admin</span>
          </div>
        </div>
        <div class="navbar-nav w-100">
          <!-- <a href="index.html" class="nav-item nav-link"><i class="fa-solid fa-address-card"></i>會員總覽</a> -->
          <!-- <a href="memberOrderManage.html" class="nav-item nav-link"><i class="fa-solid fa-table-list"></i> 會員訂單管理</a> -->
          <!-- <a href="firm.html" class="nav-item nav-link"><i class="fa-solid fa-building-user"></i> 廠商總覽</a> -->
          <a href="activityManage.html" class="nav-item nav-link "><i class="fa-solid fa-calendar-check"></i>廠商活動管理</a>

          <a href="../adminchat/adminchat.html" class="nav-item nav-link"><i class="fa-solid fa-comments"></i> 即時客服</a>
          <a href="product.html" class="nav-item nav-link"><i class="fa-solid fa-box"></i> 周邊商品</a>
          <a href="codeSetting.html" class="nav-item nav-link"><i class="fa-solid fa-barcode"></i> 優惠碼設定</a>
          <a href="manager.html" class="nav-item nav-link active"><i class="fa-solid fa-user-tie"></i> 管理者管理</a>
          <!-- <a href="notification.html" class="nav-item nav-link"><i class="fa-solid fa-envelope"></i> 通知信</a> -->
        </div>
      </nav>
    </div>
    <!-- Sidebar End -->

    <!-- Content Start -->
    <div class="content">
      <!-- Navbar Start -->
      <nav class="navbar navbar-expand bg-light navbar-light sticky-top px-4 py-0">
        <a href="index.html" class="navbar-brand d-flex d-lg-none me-4">
          <h2 class="text-primary mb-0"><i class="fa fa-hashtag"></i></h2>
        </a>
        <a href="#" class="sidebar-toggler flex-shrink-0">
          <i class="fa fa-bars"></i>
        </a>
        <!-- <form class="d-none d-md-flex ms-4">
          <input class="form-control border-0" type="search" placeholder="Search" />
        </form> -->
        <div class="navbar-nav align-items-center ms-auto">


          <div class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
              <img class="rounded-circle me-lg-2" src="img/user.jpg" alt="" style="width: 40px; height: 40px"
                id="adminPhoto2" />
              <span id="admName2"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0">

              <a href="signin.html" class="dropdown-item" id="logOut">Log Out</a>
            </div>
          </div>
        </div>
      </nav>
      <!-- Navbar End -->

      <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
          <!-- 左侧卡片区块，占据6列，即半屏宽度 -->
          <div class="col-sm-12 col-xl-12">
            <form id="adminDetailsForm" method="post" enctype="multipart/form-data" accept-charset="UTF-8">
              <div class="bg-light rounded h-100 p-4">
                <h6 class="mb-4" style="font-size: 24px; color: #009cff">新增管理者基本資料</h6>

                <div class="mb-3"><label for="exampleInputEmail1" class="form-label">上傳你的頭貼:</label></div>
                <div class="d-flex align-items-center ms-4 mb-4">
                  <div class="position-relative">
                    <input type="file" id="admProfilePhoto" accept="image/*" style="display: none" />
                    <div id="userImageContainer" class="rounded-circle"
                      style="width: 40px; height: 40px; cursor: pointer">
                      <i class="fa-solid fa-user-tie"></i>
                    </div>
                    <div
                      class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1">
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-3 mb-3">
                    <label for="admName" class="form-label">名稱</label>
                    <input type="text" class="form-control" id="admName" style="color: lightgrey" />
                  </div>
                  <div class="col-md-3 mb-3">
                    <label for="admIdentity" class="form-label">身分</label>
                    <select class="form-select" id="admIdentity" aria-label="Floating label select example">
                      <option selected>請選擇等級</option>
                      <option value="1">一般管理者</option>
                      <option value="2">主要管理者</option>
                    </select>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label for="admStatus" class="form-label">狀態</label>
                    <select class="form-select" id="admStatus" aria-label="Floating label select example">
                      <option selected>請選擇</option>
                      <option value="1">停權</option>
                      <option value="2">正常</option>
                    </select>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="admMail" class="form-label">E-mail</label>
                    <input type="email" class="form-control" id="admMail" style="color: lightgrey" value=""
                      autocomplete="username" />
                  </div>
                  <div class="row">
                    <div class="col">
                      <div class="mb-2">
                        <label for="admPassword" class="form-label">密碼</label>
                        <div class="d-flex">
                          <input type="password" class="form-control" id="admPassword" style="width: 25%"
                            autocomplete="current-password" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-3 mb-3">
                  <label for="admBirthday" class="form-label">生日</label>
                  <input type="date" class="form-control" id="admBirthday" />
                </div>
                <div class="col-md-3 mb-3">
                  <label for="admMobile" class="form-label">手機電話</label>
                  <input type="number" class="form-control" id="admMobile" value="" />
                </div>
                <div class="col-md-3 mb-3">
                  <label for="admRight" class="form-label">權限</label>
                  <select class="form-select" id="admRight" aria-label="Floating label select example">
                    <option selected>請選擇</option>
                    <option value="1">一般管理者</option>
                    <option value="2">主要管理者</option>
                  </select>
                </div>
                <div class="row">
                  <div class="col-md-3 mb-3"><label for="admAddTime" class="form-label">創建時間:</label><span
                      id="adminCreateTimeSpan"></span></div>
                  <div class="col-md-3 mb-3"><label for="admLastModifiedTime" class="form-label">最新更改時間:</label><span
                      id="adminLastModifiedTimeSpan"></span></div>
                </div>
                <button type="button" class="btn btn-secondary m-2" id="cancel">取消</button> <button type="button"
                  class="btn btn-primary" id="insert">新增</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Footer Start -->
      <div class="container-fluid pt-4 px-4">
        <div class="bg-light rounded-top p-4">
          <div class="row">
            <div class="col-12 col-sm-6 text-center text-sm-start">&copy; <a href="#">天龍Artion</a>, All Right Reserved.
            </div>
            <div class="col-12 col-sm-6 text-center text-sm-end">
              <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
              Designed By <a href="https://htmlcodex.com">HTML Codex</a>

              Distributed By <a class="border-bottom" href="https://themewagon.com" target="_blank">ThemeWagon</a>
            </div>
          </div>
        </div>
      </div>
      <!-- Footer End -->
    </div>
    <!-- Content End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
  </div>

  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/chart/chart.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="lib/tempusdominus/js/moment.min.js"></script>
  <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
  <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>
  <script>
    let path = window.location.pathname;
    path = path.substring(0, path.indexOf("/", 1));
    const admId = localStorage.getItem("admId");
    const admName = localStorage.getItem("admName");
    console.log(admId);
    console.log(admName);

    if (admId != null) {
      const admNameSpan = $("#admName");
      const admNameSpan2 = $("#admName2");

      const adminPhoto1 = $("#adminPhoto1");
      const adminPhoto2 = $("#adminPhoto2");

      console.log(adminPhoto1);

      admNameSpan.text(admName);
      admNameSpan2.text(admName);

      $("#logOut").on("click", function () {
        localStorage.removeItem("admId");
        localStorage.removeItem("admName");

      });


      // const initialImageUrl = "img/user.jpg";
      // http://localhost:8081/artion/adminphoto?admId=1001
      const alternateImageUrl = window.location.origin + path + "/adminphoto?admId=" + admId;

      // let isInitialImage = true;

      adminPhoto1.attr("src", alternateImageUrl);
      adminPhoto2.attr("src", alternateImageUrl);

    } else {
      window.location.href = "signin.html";
    }



    //新增按鈕
    $("#insert").on("click", function (e) {
      let admin = new FormData();

      admin.append("admName", $("#admName").val());
      admin.append("admIdentity", $("#admIdentity").val());
      admin.append("admStatus", $("#admStatus").val());
      admin.append("admMail", $("#admMail").val());
      admin.append("admPassword", $("#admPassword").val());
      admin.append("admBirthday", $("#admBirthday").val());
      admin.append("admMobile", $("#admMobile").val());
      admin.append("admProfilePhoto", $("#admProfilePhoto")[0].files[0]);
      admin.append("admRight", $("#admRight").val());

      console.log(admin);

      $.ajax({
        url: `http://localhost:8081/artion/addAdmin`, // 替换为用于更新数据的后端URL
        type: "POST", // 根据你的需要选择请求类型
        data: admin, // 发送的数据
        processData: false, // 禁止处理数据
        contentType: false, // 禁止设置内容类型

        success: function () {
          e.preventDefault;
          window.location.href = "manager.html?admId=" + admId;
        },
        error: function (error) {
          // 在请求失败时执行的操作
          console.error(error);
          // 可以添加其他处理请求失败后的操作，例如显示错误消息
        },
      });
    });

    $("#cancel").on("click", function () {
      location.href = "manager.html?admId=" + admId;
    });

  </script>
  <script>
    // 获取上传照片的 input 元素
    const uploadInput = document.getElementById("admProfilePhoto");

    // 获取用于显示用户照片的容器元素
    const userImageContainer = document.getElementById("userImageContainer");

    // 当用户选择文件后触发事件
    uploadInput.addEventListener("change", function () {
      const file = uploadInput.files[0];
      if (file) {
        // 创建一个图片元素来显示用户上传的图像
        const image = document.createElement("img");
        image.src = URL.createObjectURL(file);
        image.classList.add("rounded-circle");
        image.style.width = "40px";
        image.style.height = "40px";
        // 清除容器中的子元素，添加新的图像元素
        userImageContainer.innerHTML = "";
        userImageContainer.appendChild(image);
      }
    });

    // 当用户点击用户照片容器时触发上传文件的点击事件
    userImageContainer.addEventListener("click", function () {
      uploadInput.click();
    });
  </script>
</body>

</html>